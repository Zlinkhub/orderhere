<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Azayaka Laundry</title>
  <meta name="description" content="Form pemesanan cepat Azayaka Laundry via WhatsApp. Pilih layanan, atur waktu jemput atau antar, dan pesan langsung!" />
  <style>
    * { box-sizing: border-box; }
    :root {
      --accent: #ffa93a;
      --accent-2: #ff8c00;
    }
    body{
      font-family: Arial, sans-serif;
      max-width: 420px;
      margin: 30px auto;
      background: linear-gradient(to bottom, #000000, var(--accent-2));
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 12px rgba(0,0,0,0.3);
      color: white;
      position: relative;
      -webkit-font-smoothing:antialiased;
    }
    .logo{ text-align:center; margin-bottom:15px; cursor:pointer; }
    .logo img{ width:160px; border-radius:10px; }
    h2{ text-align:center; color:var(--accent); margin-bottom:8px; }
    label{ display:block; font-weight:bold; margin-top:10px; transition:opacity .2s; }
    input, select, textarea, button { width:100%; padding:10px; margin-top:5px; border-radius:8px; border:1px solid #ccc; font-size:14px; transition:.2s; }
    input, select, textarea { color:#000; }
    input:focus, select:focus, textarea:focus{ outline:2px solid var(--accent); background:#fff8ee; }
    .required { border:2px solid #ff3b3b !important; }
    .location-row{ display:flex; gap:8px; align-items:center; }
    .loc-btn{ width:42px; height:42px; border-radius:50%; border:none; background-color:var(--accent); color:white; font-size:18px; cursor:pointer; }
    .loc-btn:hover{ opacity:.95; transform:scale(1.02); }
    .note{ font-size:12px; color:#fff4d6; margin-top:4px; margin-bottom:10px; }
    .btn{ background:rgba(255,255,255,0.08); border:1px solid var(--accent); color:white; padding:8px; border-radius:8px; cursor:pointer; text-align:center; }
    .btn.active{ background:var(--accent); color:#000; font-weight:bold; }
    .admin-btn{ background-color:#25d366; color:white; }
    .kurir-btn{ background-color:var(--accent-2); color:white; }
    .wa-note{ text-align:center; font-size:13px; margin-top:10px; background:rgba(255,255,255,0.08); padding:8px; border-radius:10px; color:#fff4d6; }
    footer{ text-align:center; font-size:12px; margin-top:15px; color:#fff4d6; }
    .service-section{ display:flex; gap:10px; margin-top:10px; }
    .col{ flex:1; }
    .col label.title{ color:#ffd27f; margin-bottom:6px; display:block; font-weight:bold; }
    #toast{ visibility:hidden; min-width:280px; background:rgba(0,0,0,0.85); color:#fff; text-align:center; border-radius:25px; padding:12px; position:fixed; left:50%; bottom:20px; transform:translateX(-50%); font-size:14px; z-index:1000; }
    #toast.show{ visibility:visible; animation: fadein .4s, fadeout .4s 3.2s; }
    @keyframes fadein { from { bottom: 0; opacity: 0 } to { bottom: 20px; opacity: 1 } }
    @keyframes fadeout { from { bottom: 20px; opacity: 1 } to { bottom: 0; opacity: 0 } }
    /* hidden admin */
    #hiddenAdminToggle{ display:none; margin-top:8px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.06); padding:8px; border-radius:8px; color:#fff; font-weight:bold; cursor:pointer; }
    #adminPanelWrap{ display:none; margin-top:12px; background:rgba(0,0,0,0.25); padding:12px; border-radius:10px; }
    .admin-row{ display:flex; gap:8px; align-items:center; }
    .small{ font-size:13px; padding:8px; border-radius:6px; }
    @media (max-width:400px){ body{ padding:15px } .logo img{ width:120px } }
  </style>
</head>
<body>
  <div class="logo" id="logoWrap" title="Klik 7x untuk mode admin">
    <img id="logoImg" src="" alt="Logo">
  </div>

  <h2 id="siteTitle">ğŸ§º Azayaka Laundry</h2>
  <p style="text-align:center;">Form pemesanan cepat via WhatsApp ğŸ’¬</p>

  <form id="laundryForm" onsubmit="event.preventDefault();">
    <label for="nama">ğŸ‘¤ Nama Customer:</label>
    <input type="text" id="nama" placeholder="Tulis nama kamu" required>

    <div class="service-section">
      <div class="col">
        <label class="title">Jenis Laundry</label>
        <div class="btn-group" id="jenisGroup">
          <div class="btn" onclick="pilihJenis('Kiloan', this)">Kiloan</div>
          <div class="btn" onclick="pilihJenis('Satuan', this)">Satuan</div>
        </div>
      </div>

      <div class="col">
        <label class="title">Pilihan Layanan</label>
        <div class="btn-group" id="layananGroup">
          <!-- diisi dari config -->
        </div>
      </div>
    </div>

    <label for="estimasi">â±ï¸ Estimasi Service:</label>
    <select id="estimasi">
      <option value="Reguler (3 hari)">Reguler (3 hari)</option>
      <option value="Express (1 hari)">Express (1 hari)</option>
      <option value="Sameday">Sameday</option>
    </select>

    <label for="delivery">ğŸšš Delivery:</label>
    <select id="delivery" onchange="updateDeliveryLabels()">
      <option value="Jemput">Jemput</option>
      <option value="Antar">Antar</option>
      <option value="Jemput & Antar">Jemput & Antar</option>
    </select>

    <label id="labelWaktu" for="waktu">ğŸ•’ Waktu Penjemputan:</label>
    <input type="time" id="waktu" required>

    <label id="labelLokasi" for="lokasi">ğŸ“ Lokasi Penjemputan:</label>
    <div class="location-row">
      <input type="text" id="lokasi" placeholder="Klik ğŸ“ untuk ambil lokasi otomatis" readonly>
      <button type="button" class="loc-btn" aria-label="Ambil lokasi otomatis" onclick="ambilLokasi()">ğŸ“</button>
    </div>
    <p class="note" id="noteLokasi">ğŸ“ Aktifkan lokasi & gunakan browser seperti <b>Chrome</b> agar fitur lokasi berfungsi.</p>

    <label for="alamat">ğŸ  Alamat Singkat:</label>
    <input type="text" id="alamat" placeholder="Contoh: i01/38" required>

    <button type="button" class="admin-btn" onclick="kirimPesan('admin')">âœ‰ï¸ Kirim ke Admin</button>
    <button type="button" class="kurir-btn" onclick="kirimPesan('kurir')">ğŸšš Kirim ke Kurir</button>

    <div class="wa-note">ğŸ’¡ Pastikan WhatsApp Anda aktif sebelum mengirim pesan agar pesanan terkirim dengan lancar.</div>

    <div style="text-align:center; margin-top:8px;">
      <button type="button" id="hiddenAdminToggle" class="small" onclick="showAdminPanel()">ğŸ” Admin</button>
    </div>

    <!-- Admin panel: preview/save/download -->
    <div id="adminPanelWrap">
      <h3 style="margin-top:0;">âš™ï¸ Admin (Preview & Download)</h3>

      <label>Logo (upload atau paste URL)</label>
      <input type="file" id="logoUpload" accept="image/*" onchange="handleLogoUpload(event)" />
      <input type="text" id="logoUrl" placeholder="Atau tempel URL logo di sini" onblur="setLogoFromUrl()" />

      <label>Nama Laundry</label>
      <input type="text" id="adminNama" placeholder="Nama laundry" />

      <label>Warna Tema (gradasi: hitam â†’ warna ini)</label>
      <input type="color" id="adminWarna" value="#ff8c00" />

      <label>Daftar Layanan Satuan (pisahkan koma)</label>
      <textarea id="adminLayanan" placeholder="Contoh: Dry Clean, Bedcover, Sepatu, Karpet" style="height:80px"></textarea>

      <div class="admin-row" style="margin-top:8px;">
        <button type="button" onclick="previewLocalChanges()" class="small">Preview Lokal</button>
        <button type="button" onclick="saveLocalConfig()" class="small" style="background:#25d366">Simpan Lokal</button>
        <button type="button" onclick="downloadConfig()" class="small" style="background:#444">Download config.json</button>
      </div>

      <div style="margin-top:8px; color:#fff4d6;" id="adminMsg"></div>
      <div style="margin-top:6px;">
        <button type="button" onclick="hideAdminPanel()" class="small" style="background:#b22222">Tutup Admin</button>
      </div>
    </div>

  </form>

  <footer>Â© <span id="year"></span> <span id="footerName">Azayaka Laundry</span> | Shiny, Fresh, & Clean âœ¨</footer>
  <div id="toast"></div>

<script>
/* Config loading + UI logic (front-end only) */
/* DEFAULT CONFIG */
const DEFAULT_CONFIG = {
  namaLaundry: "Azayaka Laundry",
  logo: "https://static.1010dry.id/pesanlaundry/images/5f486d5d5fb3cbf0ab6dc2278ee9a997.png",
  warna: "#ff8c00",
  layananSatuan: ["Dry Clean","Pakaian","Bedcover","Sepatu","Karpet"]
};
/* raw config location (root) */
const RAW_CONFIG_URL = "https://raw.githubusercontent.com/Zlinkhub/orderhere/main/config.json";

let config = null;
let lokasiTeks = "";
let jenisDipilih = "";
let layananDipilih = "";

/* toast */
function showToast(msg){
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.className = "show";
  setTimeout(()=> t.className = t.className.replace("show",""), 3500);
}

/* load flow: prefer localStorage override, else fetch raw config, else default */
async function loadConfig(){
  const local = localStorage.getItem("orderhere_config");
  if(local){
    try { applyConfig(JSON.parse(local)); return; } catch(e){ console.warn("local parse err", e); }
  }
  try {
    const r = await fetch(RAW_CONFIG_URL, {cache: "no-store"});
    if(r.ok){
      const j = await r.json();
      applyConfig(j);
      return;
    }
  } catch(e){ console.warn("fetch config failed", e); }
  applyConfig(DEFAULT_CONFIG);
}

/* apply config to UI */
function applyConfig(c){
  config = Object.assign({}, DEFAULT_CONFIG, c || {});
  document.getElementById("logoImg").src = config.logo;
  document.getElementById("siteTitle").textContent = "ğŸ§º " + config.namaLaundry;
  document.getElementById("footerName").textContent = config.namaLaundry;
  document.documentElement.style.setProperty('--accent', shadeHex(config.warna, -5) || "#ffa93a");
  document.documentElement.style.setProperty('--accent-2', config.warna || "#ff8c00");
  populateLayanan(config.layananSatuan || []);
}

/* populate layanan (kiloan + satuan from config) */
function populateLayanan(satuanList){
  const layananGroup = document.getElementById("layananGroup");
  layananGroup.innerHTML = "";
  const kiloan = ["Cuci & Setrika","Setrika Saja","Cuci Kering Lipat"];
  kiloan.forEach(item => {
    const d = document.createElement("div");
    d.className = "btn layanan-btn kiloan";
    d.textContent = item;
    d.onclick = ()=> pilihLayanan(item, d);
    layananGroup.appendChild(d);
  });
  (satuanList||[]).forEach(item => {
    const d = document.createElement("div");
    d.className = "btn layanan-btn satuan";
    d.textContent = item;
    d.onclick = ()=> pilihLayanan(item, d);
    layananGroup.appendChild(d);
  });
  document.querySelectorAll('.layanan-btn').forEach(btn => btn.style.display = "none");
}

/* shade helper */
function shadeHex(hex, percent){
  try{
    hex = hex.replace('#','');
    let R = parseInt(hex.substring(0,2),16);
    let G = parseInt(hex.substring(2,4),16);
    let B = parseInt(hex.substring(4,6),16);
    R = parseInt(R*(100+percent)/100); G = parseInt(G*(100+percent)/100); B = parseInt(B*(100+percent)/100);
    R = (R<255)?R:255; G = (G<255)?G:255; B = (B<255)?B:255;
    const rr=(R.toString(16).length==1)?"0"+R.toString(16):R.toString(16);
    const gg=(G.toString(16).length==1)?"0"+G.toString(16):G.toString(16);
    const bb=(B.toString(16).length==1)?"0"+B.toString(16):B.toString(16);
    return "#"+rr+gg+bb;
  }catch(e){ return null; }
}

/* geolocation */
function ambilLokasi(){
  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat = pos.coords.latitude, lon = pos.coords.longitude;
      lokasiTeks = `https://www.google.com/maps?q=${lat},${lon}`;
      document.getElementById("lokasi").value = "Lokasi berhasil diambil âœ…";
      showToast("ğŸ“ Lokasi berhasil ditandai.");
    }, ()=> showToast("âš ï¸ Aktifkan izin lokasi agar kami dapat menjemput pesanan Anda."));
  } else showToast("âŒ Browser Anda tidak mendukung fitur lokasi.");
}

/* delivery labels */
function updateDeliveryLabels(){
  const delivery = document.getElementById("delivery").value;
  const labelWaktu = document.getElementById("labelWaktu");
  const labelLokasi = document.getElementById("labelLokasi");
  const lokasiInput = document.getElementById("lokasi");
  const noteLokasi = document.getElementById("noteLokasi");
  labelWaktu.style.opacity = 0; labelLokasi.style.opacity = 0; noteLokasi.style.opacity = 0;
  setTimeout(()=> {
    if(delivery === "Antar"){
      labelWaktu.textContent = "ğŸ•’ Waktu Pengantaran:";
      labelLokasi.textContent = "ğŸ“ Lokasi Pengantaran:";
      lokasiInput.placeholder = "Tulis lokasi antar atau klik ğŸ“";
      noteLokasi.innerHTML = "ğŸ“ Pastikan alamat tujuan antar sudah benar sebelum dikirim.";
    } else if(delivery === "Jemput & Antar"){
      labelWaktu.textContent = "ğŸ•’ Waktu Jemput & Antar:";
      labelLokasi.textContent = "ğŸ“ Lokasi Jemput & Antar:";
      lokasiInput.placeholder = "Klik ğŸ“ untuk ambil lokasi utama";
      noteLokasi.innerHTML = "ğŸ“ Lokasi ini akan digunakan untuk jemput dan antar pesanan.";
    } else {
      labelWaktu.textContent = "ğŸ•’ Waktu Penjemputan:";
      labelLokasi.textContent = "ğŸ“ Lokasi Penjemputan:";
      lokasiInput.placeholder = "Klik ğŸ“ untuk ambil lokasi otomatis";
      noteLokasi.innerHTML = "ğŸ“ Aktifkan lokasi & gunakan browser seperti <b>Chrome</b> agar fitur lokasi berfungsi dengan baik.";
    }
    labelWaktu.style.opacity = 1; labelLokasi.style.opacity = 1; noteLokasi.style.opacity = 1;
  }, 150);
}

/* jenis & layanan selection */
function pilihJenis(jenis, el){
  jenisDipilih = jenis;
  document.querySelectorAll('#jenisGroup .btn').forEach(btn => btn.classList.remove('active'));
  el.classList.add('active');
  document.querySelectorAll('.layanan-btn').forEach(btn=>{
    btn.style.display = btn.classList.contains(jenis.toLowerCase()) ? "block" : "none";
    btn.classList.remove('active');
  });
  layananDipilih = "";
}
function pilihLayanan(layanan, el){
  document.querySelectorAll('.layanan-btn').forEach(btn=>btn.classList.remove('active'));
  el.classList.add('active');
  layananDipilih = layanan;
}

/* WhatsApp open helper */
function bukaWhatsApp(number, message){
  const isMobile = /Android|iPhone/i.test(navigator.userAgent);
  const base = isMobile ? `https://wa.me/${number}?text=` : `https://web.whatsapp.com/send?phone=${number}&text=`;
  window.open(base + message, "_blank");
}

/* kirim pesan */
function kirimPesan(tujuan){
  const nama = document.getElementById("nama");
  const waktu = document.getElementById("waktu");
  const alamat = document.getElementById("alamat");
  const delivery = document.getElementById("delivery").value;
  let valid = true;
  [nama, waktu, alamat].forEach(el=>el.classList.remove("required"));
  if(!nama.value.trim()){ nama.classList.add("required"); valid=false; }
  if(!jenisDipilih){ showToast("âš ï¸ Pilih jenis laundry terlebih dahulu."); valid=false; }
  if(!layananDipilih){ showToast("âš ï¸ Pilih layanan laundry terlebih dahulu."); valid=false; }
  if(!waktu.value.trim()){ waktu.classList.add("required"); valid=false; }
  if(!lokasiTeks && !alamat.value.trim()){ alamat.classList.add("required"); valid=false; }
  if(!valid){ showToast("âš ï¸ Mohon lengkapi kolom yang ditandai merah."); return; }

  const estimasi = document.getElementById("estimasi").value;
  const tanggal = new Date().toLocaleString("id-ID", { dateStyle: "full", timeStyle: "short" });

  const pesan = `ğŸ§º *PESAN LAUNDRY* ğŸ§º
*${document.getElementById("siteTitle").textContent}*

ğŸ“… _${tanggal}_

ğŸ‘¤ Nama: ${nama.value}
ğŸ§º Jenis: ${jenisDipilih}
ğŸ§¼ Layanan: ${layananDipilih}
â±ï¸ Estimasi: ${estimasi}
ğŸšš Delivery: ${delivery}
ğŸ•’ Waktu: ${waktu.value}
ğŸ  Alamat: ${alamat.value || "-"}
ğŸ“ Lokasi: ${lokasiTeks || "Tidak terdeteksi"}

_Terima kasih sudah memesan di ${document.getElementById("siteTitle").textContent}_`;

  const nomorAdmin = "6287853561541";
  const nomorKurir = "6285246756360";
  const encoded = encodeURIComponent(pesan);
  const target = tujuan === "admin" ? nomorAdmin : nomorKurir;
  bukaWhatsApp(target, encoded);
}

/* Admin reveal via 7 clicks on logo */
let logoClickCount = 0, logoClickTimeout = null;
const REQUIRED = 7, WINDOW_MS = 3000;
document.getElementById("logoWrap").addEventListener("click", ()=>{
  logoClickCount++;
  clearTimeout(logoClickTimeout);
  logoClickTimeout = setTimeout(()=> { logoClickCount = 0; }, WINDOW_MS);
  if(logoClickCount >= REQUIRED){
    logoClickCount = 0;
    document.getElementById("hiddenAdminToggle").style.display = "inline-block";
    showToast("ğŸ” Mode admin tersedia â€” klik tombol Admin untuk membuka.");
    setTimeout(()=> document.getElementById("hiddenAdminToggle").scrollIntoView({behavior:"smooth"}), 200);
  }
});

function showAdminPanel(){
  document.getElementById("adminPanelWrap").style.display = "block";
  document.getElementById("hiddenAdminToggle").style.display = "none";
  // prefill admin inputs with current config
  document.getElementById("adminNama").value = config?.namaLaundry || DEFAULT_CONFIG.namaLaundry;
  document.getElementById("adminWarna").value = config?.warna || DEFAULT_CONFIG.warna;
  document.getElementById("adminLayanan").value = (config?.layananSatuan || DEFAULT_CONFIG.layananSatuan).join(", ");
  document.getElementById("logoUrl").value = config?.logo || DEFAULT_CONFIG.logo;
  document.getElementById("adminMsg").textContent = "Edit pengaturan lalu Preview Lokal / Simpan Lokal / Download config.json.";
}
function hideAdminPanel(){
  document.getElementById("adminPanelWrap").style.display = "none";
}

/* logo upload */
function handleLogoUpload(e){
  const f = e.target.files[0];
  if(!f) return;
  const reader = new FileReader();
  reader.onload = ev => {
    document.getElementById("logoUrl").value = ev.target.result;
    document.getElementById("logoImg").src = ev.target.result;
    document.getElementById("adminMsg").textContent = "Logo di-set (data URL). Untuk permanen, gunakan URL hosted.";
  };
  reader.readAsDataURL(f);
}
function setLogoFromUrl(){
  const url = document.getElementById("logoUrl").value.trim();
  if(url) document.getElementById("logoImg").src = url;
}

/* preview local changes */
function previewLocalChanges(){
  const newCfg = {
    namaLaundry: document.getElementById("adminNama").value.trim() || DEFAULT_CONFIG.namaLaundry,
    logo: document.getElementById("logoUrl").value.trim() || DEFAULT_CONFIG.logo,
    warna: document.getElementById("adminWarna").value || DEFAULT_CONFIG.warna,
    layananSatuan: (document.getElementById("adminLayanan").value || "").split(",").map(s=>s.trim()).filter(Boolean)
  };
  applyConfig(newCfg);
  document.getElementById("adminMsg").textContent = "Preview lokal diterapkan (belum tersimpan ke repo).";
}

/* save to localStorage */
function saveLocalConfig(){
  const newCfg = {
    namaLaundry: document.getElementById("adminNama").value.trim() || DEFAULT_CONFIG.namaLaundry,
    logo: document.getElementById("logoUrl").value.trim() || DEFAULT_CONFIG.logo,
    warna: document.getElementById("adminWarna").value || DEFAULT_CONFIG.warna,
    layananSatuan: (document.getElementById("adminLayanan").value || "").split(",").map(s=>s.trim()).filter(Boolean)
  };
  localStorage.setItem("orderhere_config", JSON.stringify(newCfg));
  document.getElementById("adminMsg").textContent = "Berhasil disimpan ke browser (localStorage).";
}

/* download config.json */
function downloadConfig(){
  const newCfg = {
    namaLaundry: document.getElementById("adminNama").value.trim() || DEFAULT_CONFIG.namaLaundry,
    logo: document.getElementById("logoUrl").value.trim() || DEFAULT_CONFIG.logo,
    warna: document.getElementById("adminWarna").value || DEFAULT_CONFIG.warna,
    layananSatuan: (document.getElementById("adminLayanan").value || "").split(",").map(s=>s.trim()).filter(Boolean)
  };
  const blob = new Blob([JSON.stringify(newCfg, null, 2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "config.json"; document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
  document.getElementById("adminMsg").textContent = "File config.json didownload. Upload file ini ke repo (path: /config.json).";
}

/* init */
(async function init(){
  await loadConfig();
  document.getElementById("year").textContent = new Date().getFullYear();
  // hide layanan until jenis chosen
  document.querySelectorAll('.layanan-btn').forEach(btn => btn.style.display = "none");
  // show browser-top hint in webviews
  const ua = navigator.userAgent.toLowerCase();
  if(ua.includes("wv")||ua.includes("micromessenger")||ua.includes("miui")||ua.includes("fb")||ua.includes("instagram")){
    setTimeout(()=> document.getElementById("browserTop")?.style.display = "block", 7000);
  }
})();
</script>
</body>
</html>


---